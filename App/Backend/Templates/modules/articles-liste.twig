{% extends '@admin/layout.twig' %}

{% block stylesheets %}
    <!-- Datatables -->
    <link href="{{ link('back/css/dataTables.bootstrap.min.css') }}" rel="stylesheet" >
    <link href="{{ link('back/css/dataTables.bootstrap.min.css') }}" rel="stylesheet" >
    <link href="{{ link('back/css/buttons.bootstrap.min.css') }}" rel="stylesheet" >
    <link href="{{ link('back/css/responsive.bootstrap.min.css') }}" rel="stylesheet" >
{% endblock %}

{% block contenu %}
    <!-- page content -->
    <div class="right_col" role="main" >
        <div >
            {#<div class="alert alert-success" >L'article a été modifié avec succès !</div >#}
            <div class="page-title" >
                <div class="title_left" >
                    <h3 >Articles</h3 >
                </div >
            </div >

            <div class="clearfix" ></div >

            <div class="row" >
                <div class="col-md-12 col-sm-12 col-xs-12" >
                    <div class="x_panel" >
                        <div class="x_title" >
                            <h2 >Liste des articles</h2 >
                            <ul class="nav navbar-right panel_toolbox" >
                                <li ><a class="collapse-link" ><i class="fa fa-chevron-up" ></i ></a >
                                </li >
                            </ul >
                            <div class="clearfix" ></div >
                        </div >
                        <div class="x_content" >
                            <p class="text-muted font-13 m-b-30" >
                                Voici la liste complète des articles présents sur le site (publié ou non) :
                            </p >
                            <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%" >
                                <thead >
                                <tr >
                                    <th >ID</th >
                                    <th >Titre</th >
                                    <th >Date</th >
                                    <th >Action</th >
                                    <th >Publié</th >
                                </tr >
                                </thead >
                                <tbody >

                                {% for article in listeArticles %}
                                    <tr role="row" class="{% if loop.inder % 2 == 1 %}odd{% else %}even{% endif %}" >
                                        <td tabindex="0" class="sorting_1" >{{ article.id }}</td >
                                        <td >{{ article.auteur }}</td >
                                        <td >{{ article.dateCreation|date('d/m/y m:h') }}</td >
                                        <td >
                                            <form >
                                                <a href="article-modifier.php" class="btn btn-sm btn-primary" >Modifier</a >
                                            </form >
                                            <form class="form-supprimer" action="/publier" method="post" >
                                                <button type="submit" data-toggle="modal" data-target="#confirm-submit" class="btn btn-sm btn-success bouton-supprimer" >{% if article.publicated == 0 %}Publier{% else %}Dépublier{% endif %}</button >
                                            </form >
                                            <form data-titre="titre" class="form-supprimer" action="/supprimer" method="post" >
                                                <button type="submit" data-toggle="modal" data-target="#confirm-submit" class="btn btn-sm btn-danger bouton-supprimer" >Supprimer</button >
                                            </form >
                                        </td >
                                        <td ><span class="fa {% if article.publicated == 0 %}fa-close red{% else %}fa-check green{% endif %}" ></span ></td >
                                    </tr >
                                {% endfor %}
                                </tbody >
                            </table >

                        </div >
                    </div >
                </div >
            </div >
        </div >
    </div >
    <!-- /page content -->
    <!-- Modal de confirmation -->
    <div class="modal fade" id="confirm-submit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog" >
            <div class="modal-content" >
                <div class="modal-header" >
                    Confirmation de la suppression
                </div >
                <div class="modal-body" >
                    Êtes vous sur de vouloir supprimer l'article "<span id="modal-confirmation__titre" ></span >" ?

                </div >

                <div class="modal-footer" >
                    <button type="button" class="btn btn-default" data-dismiss="modal" >Annuler</button >
                    <a href="#" id="modal-confirmation__supprimer" class="btn btn-danger" >Supprimer</a >
                </div >
            </div >
        </div >
    </div >
{% endblock %}

{% block javascripts %}
<!-- Datatables -->
<script src="{{ link('back/js/jquery.dataTables.min.js') }}" ></script >
<script src="{{ link('back/js/dataTables.bootstrap.min.js') }}" ></script >
<script src="{{ link('back/js/dataTables.buttons.min.js') }}" ></script >
<script src="{{ link('back/js/buttons.bootstrap.min.js') }}" ></script >
<script src="{{ link('back/js/buttons.html5.min.js') }}" ></script >
<script src="{{ link('back/js/dataTables.fixedHeader.min.js') }}" ></script >
<script src="{{ link('back/js/dataTables.keyTable.min.js') }}" ></script >
<script src="{{ link('back/js/dataTables.responsive.min.js') }}" ></script >
<script src="{{ link('back/js/responsive.bootstrap.js') }}" ></script >


<!-- Datatables -->
<script >
    $(document).ready(function () {

        $('#datatable-responsive').dataTable({
            "language": {
                "url": "//cdn.datatables.net/plug-ins/1.10.13/i18n/French.json"
            }
        });

//        Modal de confirmation

        $('.form-supprimer').submit(function (e) {
            e.preventDefault();

            $('#modal-confirmation__titre').text($(this).data('titre'));

            $('#modal-confirmation__supprimer').click(function () {
                alert('submitting');
                $(this).submit();
            });
        });


    });
</script >
{% endblock %}

